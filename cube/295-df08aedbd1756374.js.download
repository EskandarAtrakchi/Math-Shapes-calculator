!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="97cd2eb9-316c-4135-9cb8-fdc9fafec947",e._sentryDebugIdIdentifier="sentry-dbid-97cd2eb9-316c-4135-9cb8-fdc9fafec947")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{15685:function(e,t,n){"use strict";n.d(t,{q:function(){return x}});var l=n(37821),r=n(78781),i=n(27036),a=n(14233),s=n(58078),o=n(17344),d=n(8862),c=n(87601),u=n(18151);function x(e){var t,n;let{user:d,following:c}=e,u=null!==(t=null==d?void 0:d.username)&&void 0!==t?t:void 0,x=null!==(n=null==d?void 0:d.avatar_url)&&void 0!==n?n:void 0,h=function(e){let t=(0,s.useContext)(o.Ti);if(t&&e)return t.username===e}(u),v=(0,l.jsx)(i.default,{src:x||"/default_avatar.png",alt:null!=u?u:"",width:24,height:24,className:"w-6 h-6",onError:e=>{let t=e.target;"/default_avatar.png"!==t.src&&(t.src="/default_avatar.png")}});return u?(0,l.jsxs)(r.zs.Root,{children:[(0,l.jsx)(r.zs.Trigger,{children:(0,l.jsx)(a.default,{className:"rounded-full border border-gray-200 overflow-hidden\n            dark:border-neutral-700 aria-disabled:opacity-50 block\n            focus:outline-none focus:shadow-[0_0_0_2px_white]",href:"/@".concat(u),children:v})}),(0,l.jsx)(r.zs.Content,{sideOffset:5,children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-4 min-w-28 text-sm",children:[(0,l.jsxs)(a.default,{href:"/@".concat(u),className:"flex flex-col items-center gap-4",children:[(0,l.jsx)(i.default,{className:"rounded-full",src:null!=x?x:"/default_avatar.png",alt:null!=u?u:"",width:48,height:48}),(0,l.jsxs)("div",{children:["@",u]})]}),!h&&(0,l.jsx)(f,{username:u,following:c}),(0,l.jsx)("div",{className:"flex items-center gap-4"})]})})]}):(0,l.jsx)("div",{className:"rounded-full border border-gray-200 overflow-hidden dark:border-neutral-700 block focus:outline-none focus:shadow-[0_0_0_2px_white]",children:v})}function f(e){let{username:t,following:n}=e,i=function(){let e=(0,d.h)(),t=(0,c.useQueryClient)();return(0,u.useMutation)({mutationFn:async t=>{let n=await e.follows.followUser({params:{usernameOrId:t}});if(200!==n.status)throw n;return n.body.follow},onMutate:e=>{t.setQueryData(["user",e],e=>({...e,following:!0}))},onSuccess:e=>{t.invalidateQueries({queryKey:["user",e.user.username]})}})}(),a=function(){let e=(0,d.h)(),t=(0,c.useQueryClient)();return(0,u.useMutation)({mutationFn:async t=>{console.log("unfollowing user");let n=await e.follows.unfollowUser({params:{usernameOrId:t}});if(200!==n.status)throw n;return t},onMutate:e=>{t.setQueryData(["user",e],e=>({...e,following:!1}))},onSuccess:e=>{t.invalidateQueries({queryKey:["user",e]})}})}();return(0,l.jsx)(r.zx,{variant:n?"outline":"solid",onClick:()=>{n?a.mutateAsync(t):i.mutateAsync(t)},children:n?"Following":"Follow"})}},23133:function(e,t,n){"use strict";n.d(t,{ML:function(){return h},W7:function(){return u},Wh:function(){return f},n8:function(){return c},q4:function(){return x},xj:function(){return v}});var l=n(37821),r=n(14581),i=n(27624),a=n(22920),s=n(58078),o=n(56942),d=n(71786);let c=(0,s.createContext)(void 0),u=(0,s.createContext)(null);function x(e){let t=(0,s.useContext)(i.DE),n=(0,s.useContext)(d.Tl),[a,x]=(0,s.useState)(void 0),f=(0,s.useContext)(i.ze);return(0,s.useEffect)(()=>{(null==t?void 0:t.id)&&f&&x(f.siteContext?(0,r.cR)(t.id,f,{allowInfiniteContext:void 0!=(0,o.Pi)()}):(0,r.cR)(t.id,{...f,siteContext:(n||[]).slice(0,-1).map(e=>({id:e.id,pinned:!1}))},{allowInfiniteContext:void 0!=(0,o.Pi)()}))},[null==t?void 0:t.id,f]),(0,l.jsx)(u.Provider,{value:x,children:(0,l.jsx)(c.Provider,{value:a,children:e.children})})}function f(e){let t=(0,s.useContext)(u);return()=>{t((0,a.Uy)(t=>{(null==t?void 0:t.siteContext)&&(t.siteContext=t.siteContext.filter(t=>t.id!==e))}))}}function h(e){let t=(0,s.useContext)(u);return n=>{t((0,a.Uy)(t=>{if(!(null==t?void 0:t.siteContext))return;let l=t.siteContext.find(t=>t.id===e);l&&(l.pinned=n)}))}}function v(e){var t,n;let l=(0,s.useContext)(c);return null==l?void 0:null===(n=l.siteContext)||void 0===n?void 0:null===(t=n.find(t=>t.id===e))||void 0===t?void 0:t.pinned}},38295:function(e,t,n){"use strict";n.d(t,{E:function(){return M},Z:function(){return D}});var l=n(37821),r=n(53644);let i=r.z.object({type:r.z.literal("edit_element"),tagId:r.z.string(),prompt:r.z.string()}),a=r.z.object({version:r.z.literal(1),operations:r.z.array(i)});var s=n(77377),o=n(14581),d=n(75380),c=n(27950),u=n(56164),x=n(56942),f=n(39089),h=n(75005),v=n(87202),g=n(38204),m=n(4387),p=n(64816),y=n(83435),w=n(21725),j=n(78781),b=n(77362),N=n(22920),C=n(27036),k=n(14233),A=n(58078),_=n(74703),S=n(11696),I=n(15685),z=n(71786),E=n(23133);function D(){let e=(0,A.useContext)(E.n8),t=null==e?void 0:e.siteContext;console.log(t);let n=(0,A.useContext)(E.W7);return(0,v.IJ)({onDragEnd:function(e){var l,r,i,a,s,o;let{active:d,over:c}=e;if(!d||!c||!t)return;let u=null===(r=d.data)||void 0===r?void 0:null===(l=r.current)||void 0===l?void 0:l.id,x=null===(a=c.data)||void 0===a?void 0:null===(i=a.current)||void 0===i?void 0:i.id,f=null===(o=d.data)||void 0===o?void 0:null===(s=o.current)||void 0===s?void 0:s.source;if(u&&x&&f){if("bookmarkList"===f||"likeList"===f)n((0,N.Uy)(e=>{if(!e||(e.siteContext||(e.siteContext=[]),-1!==e.siteContext.findIndex(e=>e.id===u)))return;let t=e.siteContext.map(e=>e.id).indexOf(x);d.rect.current.translated&&d.rect.current.translated.top+d.rect.current.translated.height/2<c.rect.top+c.rect.height/2&&(t+=1),e.siteContext.splice(t,0,{id:u,pinned:!1})}));else if(u!==x){let e=t.findIndex(e=>e.id===u),l=t.findIndex(e=>e.id===x),r=(0,g.Rp)(t,e,l);n((0,N.Uy)(e=>{e&&(e.siteContext=r)}))}}}}),(0,l.jsx)("div",{className:"flex flex-col flex-gap-6",children:(0,l.jsxs)("div",{className:"group flex flex-0 py-2 rounded-lg flex-col-reverse relative z-0 gap-4",children:[null==t&&(0,l.jsx)("div",{className:"text-xs text-gray-400 px-2 py-2",children:"Loading..."}),t&&(0,l.jsxs)(g.Fo,{items:t,strategy:g.qw,children:[null==t?void 0:t.map((e,n)=>(0,l.jsx)(M,{siteContextItem:e,index:t.length-n-1},e.id)),0===t.length&&(0,l.jsx)("div",{className:"text-xs text-gray-400 px-2 py-2",children:"No pages in context"})]})]})})}function M(e){let t=(0,z.Wo)(),n=function(e){let t=(0,h.$)();return(0,b.useQuery)({queryKey:["historyDetails",e],queryFn:async()=>{if((0,d.kM)(e))return(0,s.D2)({messages:d.vg[e],debug:!0})[0];let n=await t.from("sites").select("id,prompt,content").eq("id",e).single();if(!n.data)throw Error("No data found");let l=n.data;if(!l.content)throw Error("No content found");let r=(0,s.KI)({id:l.id,prompt:l.prompt,content:l.content});return console.log("historyState",r),r}})}(e.siteContextItem.id),{attributes:r,listeners:i,setNodeRef:a,isDragging:c,transform:u,transition:f}=(0,g.nB)({id:e.siteContextItem.id,data:{id:e.siteContextItem.id,source:"siteContext"}}),v={transform:m.ux.Transform.toString(u),transition:f},p=e.index&&!(0,x.Pi)()&&e.index>=o.wn,y=(0,l.jsx)("div",{...r,...i,className:"flex flex-col w-full items-center cursor-grab",children:(0,l.jsxs)("div",{className:"flex flex-col gap-1 py-1 pb-2 w-10",children:[(0,l.jsx)("div",{className:"h-[1px] bg-gray-300 dark:bg-neutral-500"}),(0,l.jsx)("div",{className:"h-[1px] bg-gray-300 dark:bg-neutral-500"})]})});return(0,l.jsx)("div",{ref:a,style:v,className:"flex gap-4 bg-gray-100 dark:bg-neutral-800 rounded-lg ".concat(p?"opacity-60":""),children:n.data&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Q,{historyState:n.data,currentPage:n.data.id===(null==t?void 0:t.id)}),(0,l.jsx)(U,{historyState:n.data,currentPage:n.data.id===(null==t?void 0:t.id),handle:y})]})})}function Q(e){let[t,n]=(0,A.useState)(!1),{profile:r,following:i}=(0,f.i)(e.historyState.id),a=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"absolute inset-0 gray-100 flex items-center justify-center aria-hidden:hidden bg-gray-200 rounded-lg","aria-hidden":t,children:(0,l.jsx)(w.Z,{className:"w-12 h-12 text-gray-400 animate-pulse"})}),(0,l.jsx)(C.default,{placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",className:"object-cover w-full h-full rounded-lg aria-hidden:hidden","aria-hidden":!t,src:"https://images.websim.ai/v1/site/".concat(e.historyState.id,"/600"),alt:"Screenshot of the page",loading:"eager",onLoad:()=>{n(!0)},width:96,height:96})]});return(0,d.kM)(e.historyState.id)&&(a=(0,l.jsx)("div",{className:"w-[96px] h-[96px] flex items-center justify-center bg-white dark:bg-neutral-900 rounded-lg",children:(0,l.jsx)(u.T,{className:""})})),(0,l.jsxs)(O,{className:"aria-selected:scale-[1.1] hover:scale-[1.1] z-10 transition-all duration-200 ease-in-out","aria-selected":e.currentPage,children:[(0,l.jsx)(k.default,{href:(0,S.l)(t=>{t.pathname=(0,S.z)(e.historyState.id)}),children:a}),(0,l.jsx)("div",{className:"absolute -bottom-1 -left-1",children:!(0,d.kM)(e.historyState.id)&&(0,l.jsx)(I.q,{user:r,following:i})})]})}function q(e){let t=(0,E.ML)(e.id),n=(0,E.xj)(e.id);return(0,l.jsx)("button",{className:"text-xs p-1 bg-white rounded-full dark:bg-neutral-700\n        ".concat(n?"opacity-100":"opacity-20","\n      "),type:"button",onClick:e=>{e.preventDefault(),t(!n)},children:(0,l.jsx)(F,{className:"w-4 h-4 text-gray-800 dark:text-white pointer-events-none"})})}n(99578);let F=e=>(0,l.jsx)("svg",{width:"800px",height:"800px",className:e.className,version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 490.125 490.125",children:(0,l.jsx)("g",{children:(0,l.jsx)("g",{children:(0,l.jsx)("g",{children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M300.625,5.025c-6.7-6.7-17.6-6.7-24.3,0l-72.6,72.6c-6.7,6.7-6.7,17.6,0,24.3l16.3,16.3l-40.3,40.3l-63.5-7 c-3-0.3-6-0.5-8.9-0.5c-21.7,0-42.2,8.5-57.5,23.8l-20.8,20.8c-6.7,6.7-6.7,17.6,0,24.3l108.5,108.5l-132.4,132.4 c-6.7,6.7-6.7,17.6,0,24.3c3.3,3.3,7.7,5,12.1,5s8.8-1.7,12.1-5l132.5-132.5l108.5,108.5c3.3,3.3,7.7,5,12.1,5s8.8-1.7,12.1-5 l20.8-20.8c17.6-17.6,26.1-41.8,23.3-66.4l-7-63.5l40.3-40.3l16.2,16.2c6.7,6.7,17.6,6.7,24.3,0l72.6-72.6c3.2-3.2,5-7.6,5-12.1 s-1.8-8.9-5-12.1L300.625,5.025z M400.425,250.025l-16.2-16.3c-6.4-6.4-17.8-6.4-24.3,0l-58.2,58.3c-3.7,3.7-5.5,8.8-4.9,14 l7.9,71.6c1.6,14.3-3.3,28.3-13.5,38.4l-8.7,8.7l-217.1-217.1l8.7-8.6c10.1-10.1,24.2-15,38.4-13.5l71.7,7.9 c5.2,0.6,10.3-1.2,14-4.9l58.2-58.2c6.7-6.7,6.7-17.6,0-24.3l-16.3-16.3l48.3-48.3l160.3,160.3L400.425,250.025z"})})})})});function P(e){let t=(0,E.Wh)(e.id);return(0,l.jsx)("button",{className:"text-xs p-1 bg-white rounded-full dark:bg-neutral-700",type:"button",onClick:e=>{e.preventDefault(),t()},children:(0,l.jsx)(p.Z,{className:"w-4 h-4 text-gray-800 dark:text-white pointer-events-none"})})}function U(e){var t;let n;let r=null===(t=e.historyState.debug)||void 0===t?void 0:t.messages.find(e=>"user"===e.role);console.log(e.historyState);let i=r?(0,c.QE)(r.content):null;if(i){n=(0,l.jsx)("span",{children:i});let e=function(e){let t=/!edit\s+(.+)/.exec(e);if(!t)return null;try{return a.parse(JSON.parse(t[1]))}catch(e){return console.log("invalid edit payload",e),null}}(i);e&&(n=(0,l.jsx)("div",{children:e.operations.map(e=>(0,l.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,l.jsx)("div",{className:"text-xs text-gray-500 dark:text-neutral-400",children:"Edit"}),(0,l.jsx)(y.Z,{className:"w-4 h-4 text-gray-500 dark:text-neutral-400"}),(0,l.jsx)("div",{children:e.prompt})]},e.tagId))}))}else n=null;let o=(0,s.l9)(e.historyState.url);return(0,l.jsxs)("div",{className:"group flex flex-row w-full py-2 gap-2 px-2 rounded-lg relative z-0 gap-4 text-xs flex items-start justify-stretch w-full text-left",children:[(0,l.jsxs)("div",{className:"text-black whitespace-pre-wrap flex flex-col items-start flex-1 dark:text-white",style:{overflowWrap:"anywhere"},children:[e.handle,(0,l.jsx)(L,{children:(0,l.jsxs)("div",{className:"flex flex-col",children:[i!==o&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"text-xs text-gray-500 dark:text-neutral-400 whitespace-pre-wrap break-all max-h-24",children:o}),(0,l.jsx)("div",{className:"h-[1rem]"})]}),(0,l.jsx)("span",{children:n})]})})]}),(0,l.jsx)("div",{className:"absolute top-8 -right-1",children:(0,l.jsx)(q,{id:e.historyState.id})}),(0,l.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,l.jsx)(P,{id:e.historyState.id})})]})}function L(e){let{ref:t,height:n}=(0,_.Z)(),r=n&&n>64,[i,a]=(0,A.useState)(!1);return(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsx)("div",{className:"relative\n      ".concat(e.className||""," ").concat(r?i?"":"overflow-y-clip max-h-12":"","\n      "),children:(0,l.jsx)("div",{ref:t,children:e.children})}),r&&(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)("button",{className:"text-xs text-gray-500 dark:text-neutral-200 hover:opacity-80 flex flex-row items-center gap-1",onClick:e=>{e.preventDefault(),a(!i)},children:(0,l.jsx)(j.v4,{className:"w-3 h-3 ".concat(i?"rotate-180":"")})})})]})}function O(e){return(0,l.jsx)("div",{...e,className:"relative h-24 w-24 min-w-24\n      hover:shadow-lg\n      ring-1 ring-gray-200/20 dark:ring-neutral-50/10\n      flex-0\n      shadow-md rounded-lg ".concat(e.className||""),children:e.children})}},39089:function(e,t,n){"use strict";n.d(t,{$:function(){return d},i:function(){return c}});var l=n(75380),r=n(75005),i=n(87601),a=n(77362),s=n(30675);function o(e){return["site",e,"profile_for_site"]}function d(){let e=(0,i.useQueryClient)();return(t,n)=>{e.setQueryData(o(t),n)}}function c(e){var t,n,i;let d=(0,r.$)(),c=null===(t=(0,a.useQuery)({queryKey:o(e),queryFn:async()=>{var t;let n=await d.from("sites").select("...profile!user_id(username)").eq("id",e).single();if(n.error)throw Error(n.error.message);return{username:null!==(t=n.data.username)&&void 0!==t?t:""}},enabled:!!e&&!(0,l.kM)(e)}).data)||void 0===t?void 0:t.username,u=(0,s.a)(c);return{profile:null===(n=u.data)||void 0===n?void 0:n.user,following:(null===(i=u.data)||void 0===i?void 0:i.followed_at)!==void 0}}},99578:function(){}}]);